(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{Ps1J:function(t,e,s){"use strict";s.r(e);var n=s("xi34"),i=s("q1z7"),a=s.n(i),r=s("rFsW"),o=s("fxET"),d=s("VMy6"),c=s("f3SV"),p=s("Vxjr");function u(t,e,s,n,i,a,r){try{var o=t[a](r),d=o.value}catch(t){return void s(t)}o.done?e(d):Promise.resolve(d).then(n,i)}var l,v,h=a.a.View.extend({className:"pagepassword",initialize:function(t){r.a.bindAll(this),r.a.extend(this,t),this.router=t.router,this.mag=t.mag,this.page=t.page,this.template=d.a["template-viewer-mag-page-password"]},render:function(){var t=this,e=this.mag.pass_bg,s=new o.UserModel(this.mag.user);Object(n.a)(new Image).load((function(){t.$el.html(t.template({user:s,imgSrc:e,Constants:c.c,isPagePassword:!0})),t.$parent&&(t.$parent.find(t.className).remove(),t.$parent.append(t.$el)),t.$pwdInput=t.$el.find(".password-input"),t.$openBtn=t.$el.find(".access"),t.bindDOMEvents(),r.a.delay((function(){t.$(".back, .center-content").removeClass("invisible"),r.a.delay((function(){t.$(".author, .powered").removeClass("invisible")}),700)}),200)})).prop("src",e||Object(p.findImagePath)("./viewer/mag-password/bg.jpg"))},destroy:function(){this.unbindDOMEvents()},onAccessClick:function(){var t=n.a.trim(this.$pwdInput.val());t?(this.xhr&&this.xhr.abort(),this.xhr=n.a.ajax({url:"/api/readymag/authorize",method:"POST",data:{pass:t,num_id:this.mag.num_id,page_num_id:this.page.num_id},success:function(){this.proceed()},error:function(){this.$pwdInput.focus().select(),this.shake()},context:this})):this.shake()},proceed:(l=regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=this).$(".author, .powered, .center-content").addClass("invisible"),r.a.delay((function(){e.$(".magpassword-container, .back").addClass("invisible"),r.a.delay((function(){e.remove(),e.router.restartMag({currentPage:e.page.num,refetchOnlyPrivate:!0})}),300)}),300);case 3:case"end":return t.stop()}}),t,this)})),v=function(){var t=this,e=arguments;return new Promise((function(s,n){var i=l.apply(t,e);function a(t){u(i,s,n,a,r,"next",t)}function r(t){u(i,s,n,a,r,"throw",t)}a(void 0)}))},function(){return v.apply(this,arguments)}),onPasswordKeydown:function(t){13===t.keyCode&&this.onAccessClick()},onPasswordInput:function(t){this.$(".access").toggleClass("disabled",!this.$(".password-input").val()),this.$(".password-input").toggleClass("active",this.$(".password-input").val().length>0)},shake:function(){var t=this;this.$(".password-wrapper").addClass("shake"),r.a.delay((function(){t.$(".password-wrapper").removeClass("shake")}),500)},bindDOMEvents:function(){this.$openBtn.on("click",this.onAccessClick),this.$pwdInput.on("keydown",this.onPasswordKeydown),this.$pwdInput.on("input",this.onPasswordInput)},unbindDOMEvents:function(){this.$openBtn.off("click",this.onAccessClick),this.$pwdInput.off("keydown",this.onPasswordKeydown),this.$pwdInput.off("input",this.onPasswordInput)}});e.default=h},VMy6:function(t,e,s){"use strict";var n,i,a,r=s("AIVH");function o(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(['\n\t<div class="magpassword-container">\n\t\t<div class="img-preloader"></div>\n\t\t<div class="back invisible" <%=(imgSrc ? \'style="background-image:url(\' + imgSrc + \')"\' : "")%>></div>\n\t\t<div class="center-table">\n\t\t\t<div class="center-cell">\n\t\t\t\t<div class="center-content invisible">\n\t\t\t\t\t<div class="password-wrapper">\n\t\t\t\t\t\t<div class="input-wrapper">\n\t\t\t\t\t\t\t<input type="password" class="password-input" placeholder="Enter password"<%=(isPagePassword ? \'\' : \' id="magpassword-input"\')%> required <%=(isPagePassword ? \'autocomplete="new-password"\' : \'autofocus\')%>>\n\t\t\t\t\t\t\t<div class="access disabled">Open</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<% if (!user.get(\'permissions\') || !user.get(\'permissions\').white_label) { %>\n\t\t\t<div class="author invisible">\n\t\t\t\t<div class="userpic">\n\t\t\t\t\t<a href="<%-user.getLink()%>"><img src="<%-user.getUserpic(128)%>" alt=""></a>\n\t\t\t\t\t<a href="<%-user.getLink()%>"><div class="username"><%-user.get(\'name\')%></div></a>\n\t\t\t\t</div>\n\t\t\t\t<div class="caption">Published by</div>\n\t\t\t</div>\n\t\t\t<div class="powered invisible">\n\t\t\t\t<div class="caption-powered">Made with</div>\n\t\t\t\t<a href="<%=Constants.readymag_host%>"><div class="logo-powered"></div></a>\n\t\t\t</div>\n\t\t<% } %>\n\t</div>\n']);return o=function(){return t},t}e.a=(n={},i="template-viewer-mag-page-password",a=Object(r.a)(o()),i in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,n)}}]);